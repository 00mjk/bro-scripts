Index: policy/http-identified-files.bro
===================================================================
--- policy/http-identified-files.bro	(revision 6337)
+++ policy/http-identified-files.bro	(working copy)
@@ -72,11 +72,12 @@
 	if ( msg$data_length > length )
 		return;
 
-	local abstract = sub_bytes(data, 1, magic_content_limit);
+	#local abstract = sub_bytes(data, 1, magic_content_limit);
+	local abstract = data;
 	local magic_mime = identify_data(abstract, T);
 	local magic_descr = identify_data(abstract, F);
 
-	if ( (magic_mime == watched_mime_types ||
+	if ( (watched_mime_types in magic_mime ||
 	      watched_descriptions in magic_descr) &&
 	     s$first_pending_request in s$requests )
 		{
